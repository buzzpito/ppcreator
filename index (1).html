<!DOCTYPE html>
<html lang="fr" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Page Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root[data-theme="dark"] {
    --bg: #080810;
    --bg2: #0f0f1a;
    --bg3: #13131e;
    --border: #1e1e2e;
    --border2: #2a2a3d;
    --text: #e0e0f0;
    --text2: #8888aa;
    --text3: #4a4a70;
    --accent: #f97316;
    --accent-bg: rgba(249,115,22,0.12);
    --accent-border: rgba(249,115,22,0.3);
    --success: #22c55e;
    --success-bg: rgba(34,197,94,0.08);
    --result-text: #b0b0d0;
    --toggle-bg: #1a1a2a;
    --shadow: 0 4px 24px rgba(249,115,22,0.2);
    --glow: radial-gradient(ellipse 900px 400px at 50% 0, rgba(249,115,22,0.06) 0%, transparent 65%);
  }
  :root[data-theme="light"] {
    --bg: #f4f4f8;
    --bg2: #ffffff;
    --bg3: #f0f0f6;
    --border: #e2e2ec;
    --border2: #d0d0e0;
    --text: #18182e;
    --text2: #5a5a7a;
    --text3: #9090b0;
    --accent: #ea6d0f;
    --accent-bg: rgba(234,109,15,0.08);
    --accent-border: rgba(234,109,15,0.25);
    --success: #16a34a;
    --success-bg: rgba(22,163,74,0.07);
    --result-text: #2a2a4a;
    --toggle-bg: #e5e5ef;
    --shadow: 0 4px 24px rgba(234,109,15,0.12);
    --glow: none;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    background-image: var(--glow);
    color: var(--text);
    font-family: 'DM Sans', system-ui, sans-serif;
    font-size: 14px;
    line-height: 1.6;
    min-height: 100vh;
    transition: background 0.3s, color 0.3s;
  }

  header {
    padding: 15px 28px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 13px;
    position: sticky; top: 0; z-index: 99;
    background: var(--bg);
    transition: background 0.3s, border-color 0.3s;
  }

  .logo {
    width: 36px; height: 36px;
    background: linear-gradient(135deg, var(--accent), #9a3412);
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 17px; flex-shrink: 0;
  }

  .header-text h1 {
    font-family: 'Syne', sans-serif;
    font-size: 15px; font-weight: 800;
    color: var(--text);
    transition: color 0.3s;
  }

  .header-sub { font-size: 11px; color: var(--text3); margin-top: 1px; transition: color 0.3s; }

  /* THEME TOGGLE */
  .toggle-area {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 9px;
    cursor: pointer;
  }

  .toggle-label { font-size: 12px; color: var(--text3); transition: color 0.3s; user-select: none; }

  .toggle-track {
    width: 44px; height: 24px;
    background: var(--toggle-bg);
    border: 1px solid var(--border2);
    border-radius: 999px;
    position: relative;
    transition: background 0.3s, border-color 0.3s;
  }

  .toggle-thumb {
    position: absolute;
    top: 3px; left: 3px;
    width: 16px; height: 16px;
    background: var(--accent);
    border-radius: 50%;
    transition: transform 0.25s cubic-bezier(.34,1.56,.64,1);
  }

  [data-theme="light"] .toggle-thumb { transform: translateX(20px); }

  /* MAIN */
  main { max-width: 740px; margin: 0 auto; padding: 36px 20px 80px; }

  .card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 26px;
    margin-bottom: 20px;
    transition: background 0.3s, border-color 0.3s;
  }

  .section-label {
    font-size: 10.5px; font-weight: 700;
    letter-spacing: 0.1em; text-transform: uppercase;
    color: var(--text3); margin-bottom: 18px;
    display: flex; align-items: center; gap: 10px;
    transition: color 0.3s;
  }

  .section-label::after { content: ''; flex: 1; height: 1px; background: var(--border); transition: background 0.3s; }

  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 14px; }
  @media (max-width: 520px) { .form-grid { grid-template-columns: 1fr; } }
  .full { grid-column: 1 / -1; }

  label {
    display: block;
    font-size: 10.5px; font-weight: 700;
    letter-spacing: 0.08em; text-transform: uppercase;
    color: var(--text3); margin-bottom: 6px;
    transition: color 0.3s;
  }

  input[type="text"], textarea {
    width: 100%;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 9px;
    padding: 11px 14px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 13.5px;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s, background 0.3s, color 0.3s;
  }

  input[type="text"]::placeholder,
  textarea::placeholder { color: var(--text3); }

  input[type="text"]:focus,
  textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-bg);
  }

  textarea { resize: vertical; min-height: 130px; line-height: 1.65; }

  .btn-run {
    width: 100%; padding: 13px;
    background: linear-gradient(135deg, var(--accent), #b45309);
    color: #fff; border: none; border-radius: 10px;
    font-size: 14px; font-weight: 700;
    font-family: 'Syne', sans-serif;
    cursor: pointer;
    box-shadow: var(--shadow);
    display: flex; align-items: center; justify-content: center; gap: 9px;
    transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
    margin-top: 18px;
  }

  .btn-run:disabled {
    background: var(--border2) !important;
    color: var(--text3) !important;
    box-shadow: none; cursor: not-allowed;
  }

  .btn-run:not(:disabled):hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 30px rgba(249,115,22,0.3);
  }

  /* RESULT */
  .result-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    animation: fadeUp 0.4s ease;
    transition: background 0.3s, border-color 0.3s;
  }

  .result-head {
    padding: 14px 20px;
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; justify-content: space-between;
    background: var(--bg3);
    transition: background 0.3s, border-color 0.3s;
  }

  .result-title {
    font-family: 'Syne', sans-serif;
    font-size: 13px; font-weight: 700;
    color: var(--text);
    display: flex; align-items: center; gap: 9px;
    transition: color 0.3s;
  }

  .live-dot {
    width: 8px; height: 8px;
    background: var(--success);
    border-radius: 50%;
    box-shadow: 0 0 0 3px var(--success-bg);
    animation: pulse 2s infinite;
    flex-shrink: 0;
  }

  .btn-copy {
    background: transparent;
    border: 1px solid var(--border2);
    border-radius: 7px;
    padding: 6px 13px;
    color: var(--text2);
    font-size: 12px; font-weight: 500;
    cursor: pointer; font-family: 'DM Sans', sans-serif;
    transition: border-color 0.15s, color 0.15s;
  }

  .btn-copy:hover { border-color: var(--text2); color: var(--text); }
  .btn-copy.ok { color: var(--success); border-color: var(--success); }

  .result-body {
    padding: 24px;
    white-space: pre-wrap;
    font-size: 14px; line-height: 1.9;
    color: var(--result-text);
    max-height: 560px; overflow-y: auto;
    transition: color 0.3s;
  }

  /* LOADING */
  .loading-box {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 24px;
    display: flex; align-items: center; gap: 14px;
    color: var(--text2); font-size: 13.5px;
  }

  .spinner {
    width: 20px; height: 20px;
    border: 2px solid var(--border2);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.75s linear infinite;
    flex-shrink: 0;
  }

  /* ERROR */
  .error-box {
    background: rgba(239,68,68,0.06);
    border: 1px solid rgba(239,68,68,0.18);
    border-radius: 9px;
    padding: 13px 16px;
    color: #fca5a5; font-size: 13px;
    margin-top: 14px;
  }

  /* HINT */
  .hint {
    text-align: center; padding: 52px 20px;
    color: var(--text3); font-size: 13px;
    transition: color 0.3s;
  }

  .hint-icon { font-size: 34px; margin-bottom: 12px; opacity: 0.4; }

  @keyframes spin { to { transform: rotate(360deg); } }
  @keyframes fadeUp { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
  @keyframes pulse {
    0%,100% { box-shadow: 0 0 0 3px var(--success-bg); }
    50%      { box-shadow: 0 0 0 6px rgba(34,197,94,0.03); }
  }

  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }
</style>
</head>
<body>

<header>
  <div class="logo">üõí</div>
  <div class="header-text">
    <h1>Product Page Generator</h1>
    <div class="header-sub">Shopify √ó Facebook Ads Compliant</div>
  </div>
  <div class="toggle-area" onclick="toggleTheme()">
    <span class="toggle-label" id="themeLabel">üåô Sombre</span>
    <div class="toggle-track">
      <div class="toggle-thumb"></div>
    </div>
  </div>
</header>

<main>

  <div class="card">
    <div class="section-label">Informations produit</div>

    <div class="form-grid">
      <div>
        <label>Nom du produit</label>
        <input type="text" id="productName" placeholder="ex : Friteuse Sans Huile 5L">
      </div>
      <div>
        <label>Cat√©gorie (optionnel)</label>
        <input type="text" id="productCategory" placeholder="ex : Cuisine, Sport, Beaut√©...">
      </div>
      <div class="full">
        <label>Description & Caract√©ristiques</label>
        <textarea id="productInfo" placeholder="Collez toutes les infos disponibles :&#10;‚Ä¢ Description g√©n√©rale du produit&#10;‚Ä¢ Mat√©riaux, dimensions, couleurs&#10;‚Ä¢ Caract√©ristiques techniques&#10;‚Ä¢ Usage et avantages&#10;&#10;Plus vous donnez d'infos, meilleur sera le r√©sultat."></textarea>
      </div>
    </div>

    <div id="errorBox" style="display:none;"></div>

    <button class="btn-run" id="runBtn" onclick="generate()">
      ‚ú¶ G√©n√©rer la page produit
    </button>
  </div>

  <div id="output">
    <div class="hint">
      <div class="hint-icon">üìÑ</div>
      Remplissez les informations et cliquez sur G√©n√©rer
    </div>
  </div>

</main>

<script>
const GEMINI_KEY = 'AIzaSyBF8ThT_rH4yczI590ztqI_TgvY54Fas2w';
const GEMINI_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_KEY}`;

/* ‚îÄ‚îÄ THEME ‚îÄ‚îÄ */
function toggleTheme() {
  const html = document.documentElement;
  const dark = html.getAttribute('data-theme') === 'dark';
  html.setAttribute('data-theme', dark ? 'light' : 'dark');
  document.getElementById('themeLabel').textContent = dark ? '‚òÄÔ∏è Claire' : 'üåô Sombre';
}

/* ‚îÄ‚îÄ GEMINI ‚îÄ‚îÄ */
async function callGemini(prompt) {
  let res;
  try {
    res = await fetch(GEMINI_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        contents: [{ parts: [{ text: prompt }] }],
        generationConfig: { temperature: 0.7, maxOutputTokens: 2048 }
      })
    });
  } catch (err) {
    throw new Error("Impossible de contacter l'API Gemini. Verifiez votre connexion internet.");
  }
  const data = await res.json();
  if (!res.ok) throw new Error('Gemini API : ' + (data.error?.message || res.status));
  const text = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim();
  if (!text) throw new Error('Reponse vide de l API. Reessayez.');
  return text;
}

function buildPrompt(name, category, info) {
  return `Tu es un expert en r√©daction de pages produit e-commerce en fran√ßais. Tu respectes strictement les politiques publicitaires de Facebook sur les pratiques commerciales trompeuses.

Informations du produit :
- Nom : ${name || 'Non sp√©cifi√©'}
- Cat√©gorie : ${category || 'Non sp√©cifi√©e'}
- Description et caract√©ristiques :
${info || 'Non fournie'}

G√©n√®re une page produit compl√®te selon cette structure. R√©ponds UNIQUEMENT avec la page finale, sans commentaires.

---

4 TITRES PROPOS√âS (max 8 mots, simples et descriptifs, pas √©motionnels) :
‚Ä¢ Titre 1
‚Ä¢ Titre 2
‚Ä¢ Titre 3
‚Ä¢ Titre 4

---

ACCROCHE
[Une phrase forte commen√ßant par un verbe √† l'imp√©ratif]

---

INTRODUCTION
[Pr√©sentation rapide du produit, maximum 3 lignes]

---

‚úÖ B√âN√âFICES
B√©n√©fice 1 : explication courte et r√©aliste.
B√©n√©fice 2 : explication courte et r√©aliste.
B√©n√©fice 3 : explication courte et r√©aliste.
B√©n√©fice 4 : explication courte et r√©aliste.

---

‚úÖ CARACT√âRISTIQUES
Caract√©ristique 1 : explication courte.
Caract√©ristique 2 : explication courte.
Caract√©ristique 3 : explication courte.
Caract√©ristique 4 : explication courte.

---

‚úÖ SP√âCIFICATIONS
Spec 1 : valeur factuelle.
Spec 2 : valeur factuelle.
Spec 3 : valeur factuelle.
Spec 4 : valeur factuelle.

---

‚úÖ MODE D'UTILISATION (uniquement si produit complexe)
√âtape 1 : ...
√âtape 2 : ...

---

R√àGLES STRICTES :
- Aucun emoji dans les paragraphes (seulement dans les titres de sections)
- Aucune promesse exag√©r√©e ni r√©sultat garanti
- Aucune r√©f√©rence √† des c√©l√©brit√©s
- Aucune d√©claration sensationnaliste non v√©rifiable
- Langage simple, vendeur et responsable`;
}

/* ‚îÄ‚îÄ GENERATE ‚îÄ‚îÄ */
async function generate() {
  const name     = document.getElementById('productName').value.trim();
  const category = document.getElementById('productCategory').value.trim();
  const info     = document.getElementById('productInfo').value.trim();
  const errBox   = document.getElementById('errorBox');

  errBox.style.display = 'none';

  if (!name && !info) {
    errBox.innerHTML = '<div class="error-box">‚ö†Ô∏è Veuillez entrer au moins le nom ou la description du produit.</div>';
    errBox.style.display = 'block';
    return;
  }

  const btn = document.getElementById('runBtn');
  btn.disabled = true;
  btn.innerHTML = '<div class="spinner" style="width:16px;height:16px;"></div> G√©n√©ration en cours...';

  document.getElementById('output').innerHTML = `
    <div class="loading-box">
      <div class="spinner"></div>
      R√©daction de la page produit en cours...
    </div>
  `;

  try {
    const result = await callGemini(buildPrompt(name, category, info));
    showResult(result);
  } catch (e) {
    document.getElementById('output').innerHTML = '';
    errBox.innerHTML = `<div class="error-box">‚ùå ${escHtml(e.message)}</div>`;
    errBox.style.display = 'block';
  } finally {
    btn.disabled = false;
    btn.innerHTML = '‚ú¶ Reg√©n√©rer la page produit';
  }
}

function showResult(text) {
  window._result = text;
  document.getElementById('output').innerHTML = `
    <div class="result-card">
      <div class="result-head">
        <div class="result-title">
          <div class="live-dot"></div>
          Page produit g√©n√©r√©e
        </div>
        <button class="btn-copy" id="copyBtn" onclick="copyResult()">üìã Copier</button>
      </div>
      <div class="result-body">${escHtml(text)}</div>
    </div>
  `;
  document.getElementById('output').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function copyResult() {
  navigator.clipboard.writeText(window._result || '');
  const btn = document.getElementById('copyBtn');
  btn.textContent = '‚úì Copi√© !';
  btn.classList.add('ok');
  setTimeout(() => { btn.textContent = 'üìã Copier'; btn.classList.remove('ok'); }, 2200);
}

function escHtml(s) {
  return String(s)
    .replace(/&/g,'&amp;')
    .replace(/</g,'&lt;')
    .replace(/>/g,'&gt;');
}
</script>
</body>
</html>
